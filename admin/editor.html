<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor | Admin</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="css/admin.css">
    <style>
        /* ─── Word-like Editor Styles ────────────────────────── */
        .editor-page {
            padding: 1.5rem;
        }

        .editor-page>*+* {
            margin-top: 1.25rem;
        }

        .meta-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
        }

        .word-toolbar {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 0;
            display: flex;
            flex-direction: column;
        }

        .word-toolbar-tabs {
            display: flex;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
        }

        .word-toolbar-tab {
            padding: 0.5rem 1rem;
            font-family: var(--font-display);
            font-size: 0.625rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--fg-subtle);
            background: none;
            border: none;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .word-toolbar-tab.active,
        .word-toolbar-tab:hover {
            color: var(--cyan);
            border-bottom-color: var(--cyan);
        }

        .word-toolbar-ribbon {
            display: flex;
            align-items: center;
            gap: 0;
            padding: 0.5rem;
            flex-wrap: wrap;
        }

        .toolbar-group {
            display: flex;
            align-items: center;
            gap: 2px;
            padding: 0 0.5rem;
            border-right: 1px solid var(--border);
        }

        .toolbar-group:last-child {
            border-right: none;
        }

        .toolbar-group-label {
            display: block;
            font-family: var(--font-display);
            font-size: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: var(--fg-subtle);
            text-align: center;
            padding-top: 2px;
        }

        .tb {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2px;
            padding: 0.375rem 0.5rem;
            background: none;
            border: 1px solid transparent;
            color: var(--fg-muted);
            cursor: pointer;
            transition: all 0.2s;
            min-width: 36px;
            font-family: var(--font-display);
        }

        .tb:hover {
            background: var(--bg-tertiary);
            color: var(--cyan);
            border-color: var(--border);
        }

        .tb:active {
            background: rgba(0, 245, 255, 0.08);
        }

        .tb svg {
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }

        .tb-label {
            font-size: 0.5625rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            line-height: 1;
        }

        .tb.tb-text-only {
            flex-direction: row;
            font-size: 0.75rem;
            font-weight: 700;
            gap: 0;
            min-width: 28px;
        }

        /* Main writing area + preview */
        .writing-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            border: 1px solid var(--border);
            height: 60vh;
            min-height: 400px;
        }

        .writing-pane {
            display: flex;
            flex-direction: column;
        }

        .writing-pane-tab {
            padding: 0.625rem 1rem;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            font-family: var(--font-display);
            font-size: 0.625rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: var(--fg-subtle);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .writing-pane-tab .dot {
            width: 6px;
            height: 6px;
            background: var(--cyan);
        }

        .writing-pane-tab .dot.green {
            background: var(--green);
        }

        .writing-editor {
            flex: 1;
            padding: 1.5rem;
            background: #0d0d0d;
            border: none;
            color: var(--fg-muted);
            font-family: var(--font-body);
            font-size: 1rem;
            line-height: 1.8;
            resize: none;
            outline: none;
        }

        .writing-preview {
            flex: 1;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-left: 1px solid var(--border);
            overflow-y: auto;
            color: var(--fg-muted);
            font-size: 1rem;
            line-height: 1.8;
        }

        .writing-preview h1,
        .writing-preview h2,
        .writing-preview h3 {
            font-family: var(--font-display);
            color: var(--fg);
            margin: 1.5em 0 0.5em;
        }

        .writing-preview h1 {
            font-size: 1.75em;
        }

        .writing-preview h2 {
            font-size: 1.375em;
        }

        .writing-preview h3 {
            font-size: 1.125em;
        }

        .writing-preview p {
            margin-bottom: 1em;
        }

        .writing-preview code {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            padding: 0.125em 0.375em;
            font-family: var(--font-mono);
            font-size: 0.875em;
            color: var(--cyan);
        }

        .writing-preview pre {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            padding: 1rem;
            overflow-x: auto;
            margin: 1em 0;
        }

        .writing-preview pre code {
            background: transparent;
            border: none;
            padding: 0;
            color: var(--fg-muted);
        }

        .writing-preview blockquote {
            border-left: 2px solid var(--cyan);
            padding-left: 1em;
            color: var(--fg-subtle);
            margin: 1em 0;
        }

        .writing-preview ul,
        .writing-preview ol {
            padding-left: 1.5em;
            margin-bottom: 1em;
        }

        .writing-preview li {
            margin-bottom: 0.375em;
        }

        .writing-preview a {
            color: var(--cyan);
        }

        .writing-preview img {
            max-width: 100%;
        }

        /* Status bar */
        .editor-status-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-top: none;
        }

        .status-info {
            display: flex;
            gap: 1.5rem;
            font-family: var(--font-mono);
            font-size: 0.6875rem;
            color: var(--fg-subtle);
        }

        .status-info span {
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }

        .status-info .accent {
            color: var(--cyan);
        }

        /* Action bar */
        .editor-actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* Upload area */
        .upload-area {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        @media (max-width: 1024px) {
            .meta-grid {
                grid-template-columns: 1fr 1fr;
            }

            .writing-area {
                grid-template-columns: 1fr;
                height: auto;
            }

            .writing-editor {
                min-height: 300px;
            }

            .writing-preview {
                min-height: 300px;
                border-left: none;
                border-top: 1px solid var(--border);
            }
        }

        @media (max-width: 640px) {
            .meta-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>

    <div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar()"></div>

    <!-- Sidebar -->
    <aside class="admin-sidebar" id="sidebar">
        <div class="admin-sidebar-brand">
            <div class="admin-sidebar-brand-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                        d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                </svg>
            </div>
            <div>
                <h2>The Blog</h2><span>Admin Panel</span>
            </div>
        </div>
        <nav class="admin-nav">
            <div class="admin-nav-section">
                <div class="admin-nav-section-title">Main</div>
                <a href="dashboard.html" class="admin-nav-item">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                    Dashboard
                </a>
                <a href="posts.html" class="admin-nav-item">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
                    </svg>
                    Posts
                </a>
                <a href="editor.html" class="admin-nav-item active">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                    New Post
                </a>
            </div>
            <div class="admin-nav-section">
                <div class="admin-nav-section-title">System</div>
                <a href="settings.html" class="admin-nav-item">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.573 1.066c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.066-2.573c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    Settings
                </a>
            </div>
        </nav>
        <div style="padding:1rem; border-top:1px solid var(--border);">
            <a href="/" target="_blank" class="admin-nav-item">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="width:18px;height:18px;">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                </svg>
                View Blog
            </a>
        </div>
    </aside>

    <!-- Main -->
    <div class="admin-main">
        <header class="admin-header">
            <div class="admin-header-left">
                <button class="sidebar-toggle" onclick="toggleSidebar()">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="width:24px;height:24px;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
                <h1 class="admin-header-title" id="page-title">New Post</h1>
            </div>
            <div class="admin-header-right">
                <div id="user-info" style="display:flex;align-items:center;gap:0.5rem;"></div>
                <button id="logout-btn" class="btn btn-ghost btn-sm">Logout</button>
            </div>
        </header>

        <div class="editor-page">
            <!-- Post Metadata -->
            <div class="meta-grid">
                <div>
                    <label class="form-label">Title</label>
                    <input type="text" id="post-title" class="form-input" placeholder="Enter post title...">
                </div>
                <div>
                    <label class="form-label">Slug</label>
                    <input type="text" id="post-slug" class="form-input" placeholder="auto-generated-slug">
                </div>
                <div>
                    <label class="form-label">Publish Date</label>
                    <input type="date" id="post-date" class="form-input">
                </div>
                <div>
                    <label class="form-label">Status</label>
                    <select id="post-status" class="form-input">
                        <option value="published">Published</option>
                        <option value="draft">Draft</option>
                    </select>
                </div>
            </div>

            <!-- Tags + Upload Row -->
            <div style="display:grid; grid-template-columns:1fr auto; gap:1rem; align-items:end;">
                <div>
                    <label class="form-label">Tags</label>
                    <div class="tag-input-container" id="tag-container"
                        onclick="document.getElementById('tag-input').focus()">
                        <input type="text" id="tag-input" class="tag-input-field"
                            placeholder="Type a tag and press Enter...">
                    </div>
                </div>
                <div class="upload-area">
                    <input type="file" id="image-upload" accept="image/*" style="display:none;">
                    <button onclick="document.getElementById('image-upload').click()" class="btn btn-ghost">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="width:16px;height:16px;">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                        Upload Image
                    </button>
                    <span id="upload-status" style="font-size:0.75rem;color:var(--fg-subtle);"></span>
                </div>
            </div>

            <!-- ═══ Word-like Toolbar ═══ -->
            <div class="word-toolbar">
                <div class="word-toolbar-tabs">
                    <button class="word-toolbar-tab active">Format</button>
                    <button class="word-toolbar-tab">Insert</button>
                </div>
                <div class="word-toolbar-ribbon" id="format-ribbon">
                    <!-- Text Style -->
                    <div class="toolbar-group">
                        <button class="tb tb-text-only" title="Bold (Ctrl+B)" onclick="insertMarkdown('**', '**')">
                            <strong>B</strong>
                        </button>
                        <button class="tb tb-text-only" title="Italic (Ctrl+I)" onclick="insertMarkdown('*', '*')"
                            style="font-style:italic;">
                            <em>I</em>
                        </button>
                        <button class="tb tb-text-only" title="Strikethrough" onclick="insertMarkdown('~~', '~~')"
                            style="text-decoration:line-through;">
                            S
                        </button>
                        <div class="toolbar-group-label">Text</div>
                    </div>
                    <!-- Headings -->
                    <div class="toolbar-group">
                        <button class="tb" title="Heading 1" onclick="insertLineStart('# ')">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M5 4v3h5.5v12h3V7H19V4z" />
                            </svg>
                            <span class="tb-label">H1</span>
                        </button>
                        <button class="tb" title="Heading 2" onclick="insertLineStart('## ')">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M5 4v3h5.5v12h3V7H19V4z" />
                            </svg>
                            <span class="tb-label">H2</span>
                        </button>
                        <button class="tb" title="Heading 3" onclick="insertLineStart('### ')">
                            <svg viewBox="0 0 24 24" fill="currentColor" style="width:14px;height:14px;">
                                <path d="M5 4v3h5.5v12h3V7H19V4z" />
                            </svg>
                            <span class="tb-label">H3</span>
                        </button>
                        <div class="toolbar-group-label">Heading</div>
                    </div>
                    <!-- Lists -->
                    <div class="toolbar-group">
                        <button class="tb" title="Bullet List" onclick="insertLineStart('- ')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="9" y1="6" x2="20" y2="6" />
                                <line x1="9" y1="12" x2="20" y2="12" />
                                <line x1="9" y1="18" x2="20" y2="18" />
                                <circle cx="5" cy="6" r="1.5" fill="currentColor" />
                                <circle cx="5" cy="12" r="1.5" fill="currentColor" />
                                <circle cx="5" cy="18" r="1.5" fill="currentColor" />
                            </svg>
                            <span class="tb-label">Bullets</span>
                        </button>
                        <button class="tb" title="Numbered List" onclick="insertLineStart('1. ')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="10" y1="6" x2="20" y2="6" />
                                <line x1="10" y1="12" x2="20" y2="12" />
                                <line x1="10" y1="18" x2="20" y2="18" /><text x="3" y="8" fill="currentColor"
                                    font-size="8" font-weight="bold" stroke="none">1</text><text x="3" y="14"
                                    fill="currentColor" font-size="8" font-weight="bold" stroke="none">2</text><text
                                    x="3" y="20" fill="currentColor" font-size="8" font-weight="bold"
                                    stroke="none">3</text>
                            </svg>
                            <span class="tb-label">Numbers</span>
                        </button>
                        <button class="tb" title="Blockquote" onclick="insertLineStart('> ')">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z" />
                            </svg>
                            <span class="tb-label">Quote</span>
                        </button>
                        <div class="toolbar-group-label">Paragraph</div>
                    </div>
                    <!-- Code -->
                    <div class="toolbar-group">
                        <button class="tb" title="Inline Code" onclick="insertMarkdown('`', '`')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round">
                                <polyline points="16 18 22 12 16 6" />
                                <polyline points="8 6 2 12 8 18" />
                            </svg>
                            <span class="tb-label">Code</span>
                        </button>
                        <button class="tb" title="Code Block" onclick="insertMarkdown('\n```\n', '\n```\n')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round">
                                <rect x="3" y="3" width="18" height="18" rx="0" />
                                <polyline points="8 10 6 12 8 14" />
                                <polyline points="16 10 18 12 16 14" />
                                <line x1="12" y1="8" x2="12" y2="16" />
                            </svg>
                            <span class="tb-label">Block</span>
                        </button>
                        <div class="toolbar-group-label">Code</div>
                    </div>
                    <!-- Insert -->
                    <div class="toolbar-group">
                        <button class="tb" title="Insert Link" onclick="insertMarkdown('[', '](url)')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round">
                                <path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" />
                                <path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" />
                            </svg>
                            <span class="tb-label">Link</span>
                        </button>
                        <button class="tb" title="Insert Image" onclick="insertMarkdown('![alt](', ')')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round">
                                <rect x="3" y="3" width="18" height="18" rx="0" />
                                <circle cx="8.5" cy="8.5" r="1.5" />
                                <path d="M21 15l-5-5L5 21" />
                            </svg>
                            <span class="tb-label">Image</span>
                        </button>
                        <button class="tb" title="Horizontal Rule" onclick="insertMarkdown('\n---\n', '')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="3" y1="12" x2="21" y2="12" />
                            </svg>
                            <span class="tb-label">Line</span>
                        </button>
                        <div class="toolbar-group-label">Insert</div>
                    </div>
                </div>
            </div>

            <!-- ═══ Writing Area + Preview ═══ -->
            <div class="writing-area">
                <div class="writing-pane">
                    <div class="writing-pane-tab">
                        <span class="dot"></span>
                        Markdown Editor
                    </div>
                    <textarea id="editor" class="writing-editor" placeholder="Start writing your blog post here...

You can use formatting from the toolbar above, or type Markdown directly:

# Heading 1
## Heading 2
**Bold text** and *italic text*
- Bullet points
1. Numbered lists
> Blockquotes
`inline code`"></textarea>
                </div>
                <div class="writing-pane">
                    <div class="writing-pane-tab">
                        <span class="dot green"></span>
                        Live Preview
                    </div>
                    <div id="preview" class="writing-preview">
                        <p style="color:var(--fg-subtle); font-style:italic;">Preview will appear here as you type...
                        </p>
                    </div>
                </div>
            </div>

            <!-- Status Bar -->
            <div class="editor-status-bar">
                <div class="status-info">
                    <span><span class="accent">⬤</span> <span id="word-count">0 words</span></span>
                    <span>⏱ <span id="reading-time">0 min read</span></span>
                    <span>Markdown</span>
                </div>
                <div class="status-info">
                    <span>Auto-saved</span>
                </div>
            </div>

            <!-- Actions -->
            <div class="editor-actions">
                <a href="posts.html" class="btn btn-ghost">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="width:16px;height:16px;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Back to Posts
                </a>
                <div style="display:flex;align-items:center;gap:0.75rem;">
                    <button id="save-draft-btn" onclick="publish('draft')" class="btn btn-ghost">Save as Draft</button>
                    <button id="publish-btn" onclick="publish()" class="btn btn-primary">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="width:16px;height:16px;">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                        </svg>
                        Publish
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/api.js"></script>
    <script src="js/editor.js"></script>
    <script>
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('sidebar-overlay').classList.toggle('active');
        }
    </script>
</body>

</html>